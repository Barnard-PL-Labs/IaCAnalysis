Resources:
  Repository22E53BBD:
    Type: AWS::ECR::Repository
    Properties:
      ImageScanningConfiguration:
        ScanOnPush: true
      RepositoryName: ubuntu-build
    UpdateReplacePolicy: Retain
    DeletionPolicy: Retain
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/Repository/Resource
  MainBuildProjectRole713F45E3:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: codebuild.amazonaws.com
        Version: "2012-10-17"
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/MainBuild/Project/Role/Resource
  MainBuildProjectRoleDefaultPolicyCE90998F:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:CreateLogGroup
              - logs:CreateLogStream
              - logs:PutLogEvents
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":logs:"
                    - Ref: AWS::Region
                    - ":"
                    - Ref: AWS::AccountId
                    - :log-group:/aws/codebuild/
                    - Ref: MainBuildProject556FF1BB
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":logs:"
                    - Ref: AWS::Region
                    - ":"
                    - Ref: AWS::AccountId
                    - :log-group:/aws/codebuild/
                    - Ref: MainBuildProject556FF1BB
                    - :*
          - Action:
              - codebuild:CreateReportGroup
              - codebuild:CreateReport
              - codebuild:UpdateReport
              - codebuild:BatchPutTestCases
              - codebuild:BatchPutCodeCoverages
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":codebuild:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :report-group/
                  - Ref: MainBuildProject556FF1BB
                  - -*
          - Action:
              - ecr:BatchCheckLayerAvailability
              - ecr:GetDownloadUrlForLayer
              - ecr:BatchGetImage
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - Repository22E53BBD
                - Arn
          - Action: ecr:GetAuthorizationToken
            Effect: Allow
            Resource: "*"
          - Action:
              - ecr:PutImage
              - ecr:InitiateLayerUpload
              - ecr:UploadLayerPart
              - ecr:CompleteLayerUpload
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - Repository22E53BBD
                - Arn
          - Action:
              - secretsmanager:GetSecretValue
              - secretsmanager:DescribeSecret
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":secretsmanager:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :secret:github-token-??????
        Version: "2012-10-17"
      PolicyName: MainBuildProjectRoleDefaultPolicyCE90998F
      Roles:
        - Ref: MainBuildProjectRole713F45E3
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/MainBuild/Project/Role/DefaultPolicy/Resource
  MainBuildProject556FF1BB:
    Type: AWS::CodeBuild::Project
    Properties:
      Artifacts:
        Type: NO_ARTIFACTS
      Environment:
        ComputeType: BUILD_GENERAL1_SMALL
        Image: aws/codebuild/standard:5.0
        ImagePullCredentialsType: CODEBUILD
        PrivilegedMode: true
        Type: LINUX_CONTAINER
      ServiceRole:
        Fn::GetAtt:
          - MainBuildProjectRole713F45E3
          - Arn
      Source:
        BuildSpec:
          Fn::Join:
            - ""
            - - |-
                {
                  "version": "0.2",
                  "env": {
                    "secrets-manager": {
                      "GITHUB_TOKEN": "arn:
              - Ref: AWS::Partition
              - ":secretsmanager:"
              - Ref: AWS::Region
              - ":"
              - Ref: AWS::AccountId
              - |-
                :secret:github-token"
                    },
                    "variables": {
                      "DOCKER_BUILDKIT": 1
                    }
                  },
                  "phases": {
                    "pre_build": {
                      "commands": [
                        "VERSION=$(git tag --points-at)",
                        "aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login -u AWS --password-stdin 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                ",
                        "if [ -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :golang || true; fi",
                        "if [ -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :nodejs || true; fi",
                        "if [ -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :python || true; fi",
                        "if [ -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :ruby || true; fi",
                        "if [ -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :latest || true; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-golang || true; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-nodejs || true; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-python || true; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-ruby || true; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker pull 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION || true; fi"
                      ]
                    },
                    "build": {
                      "commands": [
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --build-arg BUILDKIT_INLINE_CACHE=1 --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION --target golang .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --build-arg BUILDKIT_INLINE_CACHE=1 --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION --target nodejs .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --build-arg BUILDKIT_INLINE_CACHE=1 --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION --target python .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --build-arg BUILDKIT_INLINE_CACHE=1 --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION --target ruby .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --build-arg BUILDKIT_INLINE_CACHE=1 --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby --cache-from "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION .",
                        "TEST_PIDFILE_DIR=$(mktemp -d) && TEST_RESULTS_DIR=$(mktemp -d)",
                        "nohup docker run 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION /bin/bash -c '. /root/.asdf/asdf.sh && gem install rails' > $TEST_RESULTS_DIR/rails_install 2>&1 & echo $! > $TEST_PIDFILE_DIR/rails_install; nohup docker run "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION /bin/bash -c '. /root/.asdf/asdf.sh && pip install flask' > $TEST_RESULTS_DIR/flask_install 2>&1 & echo $! > $TEST_PIDFILE_DIR/flask_install; for file in $TEST_PIDFILE_DIR/*; do wait $(cat \"$file\") || { echo; echo \">>> TEST '$(basename \"$file\")' FAILED <<<\"; echo; cat \"$TEST_RESULTS_DIR/$(basename \"$file\")\"; exit 1; }; done && for file in $TEST_RESULTS_DIR/*; do echo; echo \">>> TEST '$(basename \"$file\")' RESULTS <<<\"; echo; cat \"$file\"; done;",
                        "npx semantic-release && VERSION=$(git tag --points-at)"
                      ]
                    },
                    "post_build": {
                      "commands": [
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-golang; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-nodejs; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-python; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-ruby; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :golang; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :nodejs; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :python; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :ruby; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :latest; fi"
                      ]
                    }
                  }
                }
        Location: https://github.com/kevjallen/ubuntu-build.git
        ReportBuildStatus: true
        Type: GITHUB
      Cache:
        Modes:
          - LOCAL_DOCKER_LAYER_CACHE
        Type: LOCAL
      EncryptionKey: alias/aws/s3
      Name: ubuntu-build-main
      Triggers:
        FilterGroups:
          - - Pattern: PUSH
              Type: EVENT
            - Pattern: refs/heads/master
              Type: HEAD_REF
            - ExcludeMatchedPattern: true
              Pattern: ^security:.*
              Type: COMMIT_MESSAGE
          - - Pattern: PULL_REQUEST_CREATED, PULL_REQUEST_REOPENED, PULL_REQUEST_UPDATED
              Type: EVENT
        Webhook: true
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/MainBuild/Project/Resource
  SecurityBuildProjectRoleD454C2B7:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: codebuild.amazonaws.com
        Version: "2012-10-17"
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/SecurityBuild/Project/Role/Resource
  SecurityBuildProjectRoleDefaultPolicy808ADF9D:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - logs:CreateLogGroup
              - logs:CreateLogStream
              - logs:PutLogEvents
            Effect: Allow
            Resource:
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":logs:"
                    - Ref: AWS::Region
                    - ":"
                    - Ref: AWS::AccountId
                    - :log-group:/aws/codebuild/
                    - Ref: SecurityBuildProject8FCA9218
              - Fn::Join:
                  - ""
                  - - "arn:"
                    - Ref: AWS::Partition
                    - ":logs:"
                    - Ref: AWS::Region
                    - ":"
                    - Ref: AWS::AccountId
                    - :log-group:/aws/codebuild/
                    - Ref: SecurityBuildProject8FCA9218
                    - :*
          - Action:
              - codebuild:CreateReportGroup
              - codebuild:CreateReport
              - codebuild:UpdateReport
              - codebuild:BatchPutTestCases
              - codebuild:BatchPutCodeCoverages
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":codebuild:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :report-group/
                  - Ref: SecurityBuildProject8FCA9218
                  - -*
          - Action:
              - ecr:BatchCheckLayerAvailability
              - ecr:GetDownloadUrlForLayer
              - ecr:BatchGetImage
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - Repository22E53BBD
                - Arn
          - Action: ecr:GetAuthorizationToken
            Effect: Allow
            Resource: "*"
          - Action:
              - ecr:PutImage
              - ecr:InitiateLayerUpload
              - ecr:UploadLayerPart
              - ecr:CompleteLayerUpload
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - Repository22E53BBD
                - Arn
          - Action:
              - secretsmanager:GetSecretValue
              - secretsmanager:DescribeSecret
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:"
                  - Ref: AWS::Partition
                  - ":secretsmanager:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :secret:github-token-??????
        Version: "2012-10-17"
      PolicyName: SecurityBuildProjectRoleDefaultPolicy808ADF9D
      Roles:
        - Ref: SecurityBuildProjectRoleD454C2B7
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/SecurityBuild/Project/Role/DefaultPolicy/Resource
  SecurityBuildProject8FCA9218:
    Type: AWS::CodeBuild::Project
    Properties:
      Artifacts:
        Type: NO_ARTIFACTS
      Environment:
        ComputeType: BUILD_GENERAL1_SMALL
        Image: aws/codebuild/standard:5.0
        ImagePullCredentialsType: CODEBUILD
        PrivilegedMode: true
        Type: LINUX_CONTAINER
      ServiceRole:
        Fn::GetAtt:
          - SecurityBuildProjectRoleD454C2B7
          - Arn
      Source:
        BuildSpec:
          Fn::Join:
            - ""
            - - |-
                {
                  "version": "0.2",
                  "env": {
                    "secrets-manager": {
                      "GITHUB_TOKEN": "arn:
              - Ref: AWS::Partition
              - ":secretsmanager:"
              - Ref: AWS::Region
              - ":"
              - Ref: AWS::AccountId
              - |-
                :secret:github-token"
                    },
                    "variables": {
                      "DOCKER_BUILDKIT": 1
                    }
                  },
                  "phases": {
                    "pre_build": {
                      "commands": [
                        "VERSION=$(git tag --points-at)",
                        "aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login -u AWS --password-stdin 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                "
                      ]
                    },
                    "build": {
                      "commands": [
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION-golang --build-arg BUILDKIT_INLINE_CACHE=1 --target golang .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs --build-arg BUILDKIT_INLINE_CACHE=1 --target nodejs .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION-python --build-arg BUILDKIT_INLINE_CACHE=1 --target python .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby --build-arg BUILDKIT_INLINE_CACHE=1 --target ruby .",
                        "docker build -t 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION --build-arg BUILDKIT_INLINE_CACHE=1 .",
                        "TEST_PIDFILE_DIR=$(mktemp -d) && TEST_RESULTS_DIR=$(mktemp -d)",
                        "nohup docker run 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION /bin/bash -c '. /root/.asdf/asdf.sh && gem install rails' > $TEST_RESULTS_DIR/rails_install 2>&1 & echo $! > $TEST_PIDFILE_DIR/rails_install; nohup docker run "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$CODEBUILD_RESOLVED_SOURCE_VERSION /bin/bash -c '. /root/.asdf/asdf.sh && pip install flask' > $TEST_RESULTS_DIR/flask_install 2>&1 & echo $! > $TEST_PIDFILE_DIR/flask_install; for file in $TEST_PIDFILE_DIR/*; do wait $(cat \"$file\") || { echo; echo \">>> TEST '$(basename \"$file\")' FAILED <<<\"; echo; cat \"$TEST_RESULTS_DIR/$(basename \"$file\")\"; exit 1; }; done && for file in $TEST_RESULTS_DIR/*; do echo; echo \">>> TEST '$(basename \"$file\")' RESULTS <<<\"; echo; cat \"$file\"; done;",
                        "npx semantic-release && VERSION=$(git tag --points-at)"
                      ]
                    },
                    "post_build": {
                      "commands": [
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-golang && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-golang; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-nodejs && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-nodejs; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-python && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-python; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION-ruby && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION-ruby; fi",
                        "if [ ! -z \"$VERSION\" ]; then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$VERSION && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :$VERSION; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-golang "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":golang && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :golang; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-nodejs "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":nodejs && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :nodejs; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-python "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":python && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :python; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION-ruby "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":ruby && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :ruby; fi",
                        "if [ ! -z \"$VERSION\" ] && ([ ! -z \"$CODEBUILD_WEBHOOK_TRIGGER\" ] || [ ! -z \"$FORCE_TAG_LATEST\" ]); then docker image tag 
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":$CODEBUILD_RESOLVED_SOURCE_VERSION "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - ":latest && docker image push "
              - Fn::Select:
                  - 4
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - .dkr.ecr.
              - Fn::Select:
                  - 3
                  - Fn::Split:
                      - ":"
                      - Fn::GetAtt:
                          - Repository22E53BBD
                          - Arn
              - "."
              - Ref: AWS::URLSuffix
              - /
              - Ref: Repository22E53BBD
              - |-
                :latest; fi"
                      ]
                    }
                  }
                }
        Location: https://github.com/kevjallen/ubuntu-build.git
        ReportBuildStatus: true
        Type: GITHUB
      Cache:
        Type: NO_CACHE
      EncryptionKey: alias/aws/s3
      Name: ubuntu-build-security
      Triggers:
        FilterGroups:
          - - Pattern: PUSH
              Type: EVENT
            - Pattern: refs/heads/master
              Type: HEAD_REF
            - Pattern: ^security:.*
              Type: COMMIT_MESSAGE
        Webhook: true
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/SecurityBuild/Project/Resource
  CDKMetadata:
    Type: AWS::CDK::Metadata
    Properties:
      Analytics: v2:deflate64:H4sIAAAAAAAA/02NzQ6CMBCEn4V7WS1evPMCBB/AwHZNFkrXtAVjmr67/Jjoab7ZzMxWoC9wLrpXKNGMpeUe0i12OKr1dE+EHlJLTwkcxb9V/XA/lxWKoX5mayA1XgbCuCW+mBV309oWS3tv00Ys4z5zUM6qpSCzxyPzx7U4w5HFZeXWNzCE06KvoCvQxRCYSz+7yBNBe+gH0RsmscoAAAA=
    Metadata:
      aws:cdk:path: UbuntuBuildPipeline/CDKMetadata/Default
    Condition: CDKMetadataAvailable
Conditions:
  CDKMetadataAvailable:
    Fn::Or:
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - af-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-northeast-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-northeast-2
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-southeast-1
          - Fn::Equals:
              - Ref: AWS::Region
              - ap-southeast-2
          - Fn::Equals:
              - Ref: AWS::Region
              - ca-central-1
          - Fn::Equals:
              - Ref: AWS::Region
              - cn-north-1
          - Fn::Equals:
              - Ref: AWS::Region
              - cn-northwest-1
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-central-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-north-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-1
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-2
          - Fn::Equals:
              - Ref: AWS::Region
              - eu-west-3
          - Fn::Equals:
              - Ref: AWS::Region
              - me-south-1
          - Fn::Equals:
              - Ref: AWS::Region
              - sa-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-east-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-east-2
      - Fn::Or:
          - Fn::Equals:
              - Ref: AWS::Region
              - us-west-1
          - Fn::Equals:
              - Ref: AWS::Region
              - us-west-2
Parameters:
  BootstrapVersion:
    Type: AWS::SSM::Parameter::Value<String>
    Default: /cdk-bootstrap/hnb659fds/version
    Description: Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]
Rules:
  CheckBootstrapVersion:
    Assertions:
      - Assert:
          Fn::Not:
            - Fn::Contains:
                - - "1"
                  - "2"
                  - "3"
                  - "4"
                  - "5"
                - Ref: BootstrapVersion
        AssertDescription: CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI.

